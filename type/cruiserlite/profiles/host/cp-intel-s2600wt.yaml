---
# The primary control plane host profile for Airship for DELL R720s, and
# should not need to be altered if you are using matching HW. The active
# participants in the Ceph cluster run on this profile. Other control plane
# services are not affected by primary vs secondary designation.
schema: drydock/HostProfile/v1
metadata:
  schema: metadata/Document/v1
  name: cp-intel-s2600wt
  storagePolicy: cleartext
  layeringDefinition:
    abstract: false
    layer: type
    parentSelector:
      hosttype: nc-cp-adv
    actions:
      - method: replace
        path: .interfaces
      - method: replace
        path: .storage
      - method: merge
        path: .
  substitutions:
    - dest:
        path: .oob.credential
      src:
        schema: deckhand/Passphrase/v1
        name: ipmi_admin_password
        path: .
    - dest:
        path: .interfaces.data1.sriov.device
      src:
        schema: drydock/HardwareProfile/v1
        name: intel-s2600wt
        path: .device_aliases.data_nic1.address
    - dest:
        path: .interfaces.data2.sriov.device
      src:
        schema: drydock/HardwareProfile/v1
        name: intel-s2600wt
        path: .device_aliases.data_nic2.address
data:
  hardware_profile: intel-s2600wt
  oob:
    type: 'ipmi'
    network: 'oob'
    # Not used. Keep for lint purpose
    account: 'tier4'

  primary_network: dmz
  interfaces:
    dmz:
      device_link: dmz
      slaves:
        - ctrl_nic1
      networks:
        - oam
    pxe:
      device_link: pxe
      slaves:
        - ctrl_nic2
      networks:
        - pxe
    data1:
      device_link: data1
      slaves:
        - data_nic1
      networks:
        - calico
        - overlay
    data2:
      device_link: data2
      slaves:
        - data_nic2
      networks:
        - storage
        - routable
      sriov:
        num_vfs: 32
        promisc: false
      ovs_dpdk:
        vf_index: 0
      pci_whitelist:
        trusted: false
  storage:
    physical_devices:
      bootdisk:
        labels:
          bootdrive: 'true'
        partitions:
          - name: 'root'
            size: '30g'
            bootable: true
            filesystem:
              mountpoint: '/'
              fstype: 'ext4'
              mount_options: 'defaults'
          - name: 'boot'
            size: '1g'
            filesystem:
              mountpoint: '/boot'
              fstype: 'ext4'
              mount_options: 'defaults'
          - name: 'var_log'
            size: '100g'
            filesystem:
              mountpoint: '/var/log'
              fstype: 'ext4'
              mount_options: 'defaults'
          - name: 'var'
            size: '>100g'
            filesystem:
              mountpoint: '/var'
              fstype: 'ext4'
              mount_options: 'defaults'
  platform:
    kernel_params:
      # NOTE: For the hugepagez config, must use real value here
      # because this list is also consumed by pre-genesis.sh to
      # configure hugepages for genesis node, and unlike drydock
      # it does not have capability to perform the necessarily
      # substitution at run time.  See nc-p1-adv profile for
      # preferred substitution pattern.
      hugepagesz: '1G'
      hugepages: '10'
  metadata:
    owner_data:
      openstack-ranger-agent: enabled
...
